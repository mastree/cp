#include <bits/stdc++.h>


#define fi first
#define se second
#define pb(a) push_back(a)
#define mp(a, b) make_pair(a, b)
#define el '\n'

using namespace std;
using ll = long long;
using pii = pair<int, int>;

const int N = 1e3 + 10;

int n, m;
int pre[N][N];
int a[N][N], b[N][N];
int h, w;

int hitung(int ra, int ca, int rb, int cb){
    return pre[rb][cb] - pre[ra - 1][cb] - pre[rb][ca - 1] + pre[ra - 1][ca - 1];
}

int main () {
    ios_base::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    cin >> n >> m;
    cin >> h >> w;
    for (int i=1;i<=n;i++){
        int cur = 0;
        for (int j=1;j<=m;j++){
            int a;
            cin >> a;
            cur += a;
            pre[i][j] = pre[i - 1][j] + cur;
        }
    }
    int ha = h;
    int wa = w;
    int hb = h;
    int wb = w;
    int ans = 0;
    for (int fa=0;fa<2;fa++){
        // kiri atas
        for (int i=1;i<=n;i++){
            int ii = i - ha + 1;
            for (int j=1;j<=m;j++){
                int jj = j - wa + 1;
                if (ii < 1 || jj < 1) a[i][j] = 0;
                else{
                    a[i][j] = max(hitung(ii, jj, i, j), max(a[i - 1][j], a[i][j - 1]));
                }
            }
        }
        // kanan bawah
        for (int i=n;i>=1;i--){
            int ii = i + ha - 1;
            for (int j=m;j>=1;j--){
                int jj = j + wa - 1;
                if (ii > n || jj > m) b[i][j] = 0;
                else{
                    b[i][j] = max(hitung(i, j, ii, jj), max(b[i + 1][j], b[i][j + 1]));
                }
            }
        }
        for (int fb=0;fb<2;fb++){
            for (int i=1;i + hb - 1<=n;i++){
                int ii = i + hb - 1;
                for (int j=1;j + wb - 1<=m;j++){
                    int jj = j + wb - 1;
                    int cur = hitung(i, j, ii, jj) + max(max(a[i - 1][m], a[n][j - 1]), max(b[ii + 1][1], b[1][jj + 1]));
                    ans = max(ans, cur);
                }
            }
            swap(hb, wb);
        }
        swap(ha, wa);
    }
    cout << ans << el;

    return 0;
}